/*
 * generated by Xtext 2.24.0
 */
package org.xtext.example.mydsl.validation;

import java.util.ArrayList;
import java.util.List;

import org.eclipse.xtext.diagnostics.Diagnostic;
import org.eclipse.xtext.validation.Check;
import org.xtext.example.mydsl.uml.Heritage;
import org.xtext.example.mydsl.uml.Implementation;
import org.xtext.example.mydsl.uml.Link;
import org.xtext.example.mydsl.uml.Relation;
import org.xtext.example.mydsl.uml.UmlObject;
import org.xtext.example.mydsl.uml.UmlPackage;

/**
 * This class contains custom validation rules. 
 *
 * See https://www.eclipse.org/Xtext/documentation/303_runtime_concepts.html#validation
 */
public class UmlValidator extends AbstractUmlValidator {
	public static final String INVALID_NAME = "invalidName";
	public static final String INVALID_QUANTITY = "invalidQuantity";
	public static final String UNDECLARED_CLASS = "undeclaredClass";
	public static final String NO_CLASS_CONTENT = "noClassContent";
	
	
	
	
	@Check
	public void checkInterfaceNameStartsWithCapital(UmlObject o) {
	    if (!Character.isUpperCase(o.getName().charAt(0))) {
	        warning("Name should start with a capital",
	            UmlPackage.Literals.UML_OBJECT__NAME, // TODO :: Change value
	            INVALID_NAME);
	    }
	}
	
	@Check
	public void checkClass1ExistInLink(Link l) {
		String className;
		if (l instanceof Heritage) {
			className = ((Heritage)l).getChildrenClass();
			if(!Diagnostic.LINKING_DIAGNOSTIC.contains(className)) {//TODO find good if
				warning("Class '"+ className + "' have not been declared", UmlPackage.Literals.HERITAGE__CHILDREN_CLASS, UNDECLARED_CLASS);
			}
		}else if (l instanceof Implementation){
			className =((Implementation)l).getChildrenClass();
			if(!Diagnostic.LINKING_DIAGNOSTIC.contains(className)) {
				warning("Class '"+ className + "' have not been declared", UmlPackage.Literals.IMPLEMENTATION__CHILDREN_CLASS, UNDECLARED_CLASS);
			}
		}else if (l instanceof Relation){
			className =((Relation)l).getNameClass1();
			if(!Diagnostic.LINKING_DIAGNOSTIC.contains(className)) {
				warning("Class '"+ className + "' have not been declared", UmlPackage.Literals.RELATION__NAME_CLASS1, UNDECLARED_CLASS);
			}
		}
	}
	
	@Check
	public void checkClass2ExistInLink(Link l) {
		String className;
		if (l instanceof Heritage) {
			className = ((Heritage)l).getSuperClass();
			if(!Diagnostic.LINKING_DIAGNOSTIC.contains(className)) {
				warning("Class '"+ className + "' have not been declared", UmlPackage.Literals.HERITAGE__SUPER_CLASS, UNDECLARED_CLASS);
			}
		}else if (l instanceof Implementation){
			className =((Implementation)l).getMotherClass();
			if(!Diagnostic.LINKING_DIAGNOSTIC.contains(className)) {
				warning("Class '"+ className + "' have not been declared", UmlPackage.Literals.IMPLEMENTATION__MOTHER_CLASS, UNDECLARED_CLASS);
			}
		}else if (l instanceof Relation){
			className =((Relation)l).getNameClass2();
			if(!Diagnostic.LINKING_DIAGNOSTIC.contains(className)) {
				warning("Class '"+ className + "' have not been declared", UmlPackage.Literals.RELATION__NAME_CLASS2, UNDECLARED_CLASS);
			}
		}
	}

}
